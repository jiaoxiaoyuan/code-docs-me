import{D as b,e as B,o as l,c as p,b as k,j as i,P as w,n as S,an as v,ao as g,I as m,t as f,J as D,F,E as H,a as P}from"./framework.qnZckW2M.js";var Y=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function j(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var I={exports:{}};(function(t,e){(function(a,r){t.exports=r()})(Y,function(){if(typeof window=="object"&&!(document.querySelectorAll===void 0||window.pageYOffset===void 0||history.pushState===void 0)){var a=function(s,u){return s.nodeName==="HTML"?-u:s.getBoundingClientRect().top+u},r=function(s){return s<.5?4*s*s*s:(s-1)*(2*s-2)*(2*s-2)+1},o=function(s,u,n,h){return n>h?u:s+(u-s)*r(n/h)},d=function(s,u,n,h){u=u||500,h=h||window;var x=h.scrollTop||window.pageYOffset;if(typeof s=="number")var E=parseInt(s);else var E=a(s,x);var V=Date.now(),U=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(L){window.setTimeout(L,15)},N=function(){var L=Date.now()-V;h!==window?h.scrollTop=o(x,E,L,u):window.scroll(0,o(x,E,L,u)),L>u?typeof n=="function"&&n(s):U(N)};N()},c=function(s){if(!s.defaultPrevented){s.preventDefault(),location.hash!==this.hash&&window.history.pushState(null,null,this.hash);var u=document.getElementById(this.hash.substring(1));if(!u)return;d(u,500,function(n){location.replace("#"+n.id)})}};return document.addEventListener("DOMContentLoaded",function(){for(var s=document.querySelectorAll('a[href^="#"]:not([href="#"])'),u,n=s.length;u=s[--n];)u.addEventListener("click",c,!1)}),d}})})(I);var W=I.exports;const O=j(W),M=/mobile/i.test(window.navigator.userAgent),_={isMobile:M,eventsName:{moveStart:M?"touchstart":"mousedown",moving:M?"touchmove":"mousemove",moveEnd:M?"touchend":"mouseup"},storage:{set:(t,e)=>{localStorage.setItem(t,e)},get:t=>{localStorage.getItem(t)}},secondToTime:t=>{const e=d=>d<10?"0"+d:""+d,a=Math.floor(t/3600),r=Math.floor((t-a*3600)/60),o=Math.floor(t-a*3600-r*60);return(a>0?[a,r,o]:[r,o]).map(e).join(":")},randomOrder:t=>{function e(a){for(let r=a.length-1;r>=0;r--){const o=Math.floor(Math.random()*(r+1)),d=a[o];a[o]=a[r],a[r]=d}return a}return e([...Array(t)].map(function(a,r){return r}))},parse(t){if(t){t=t.replace(/([^\]^\n])\[/g,(r,o)=>o+`
[`);let e=t.split(`
`),a=[];for(let r=0;r<e.length;r++){const o=e[r].match(/\[(\d{2}):(\d{2})(\.(\d{2,3}))?]/g),d=e[r].replace(/.*\[(\d{2}):(\d{2})(\.(\d{2,3}))?]/g,"").replace(/<(\d{2}):(\d{2})(\.(\d{2,3}))?>/g,"").replace(/^\s+|\s+$/g,"");if(o)for(let c=0;c<o.length;c++){const s=/\[(\d{2}):(\d{2})(\.(\d{2,3}))?]/.exec(o[c]),u=s[1]*60,n=parseInt(s[2]),h=s[4]?parseInt(s[4])/((s[4]+"").length===2?100:1e3):0,x=u+n+h;a.push([x,d])}}return a=a.filter(r=>r[1]),a.sort((r,o)=>r[0]-o[0]),a}else return[]}},y=_,X={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 31"},J=i("path",{d:"M15.552 15.168q.448.32.448.832 0 .448-.448.768L1.856 25.28q-.768.512-1.312.192T0 24.192V7.744q0-.96.544-1.28t1.312.192z"},null,-1),Q=[J];function G(t,e){return l(),p("svg",X,[...Q])}const K={render:G},Z={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 17 32"},tt=i("path",{d:"M14.08 4.8q2.88 0 2.88 2.048v18.24q0 2.112-2.88 2.112t-2.88-2.112V6.848q0-2.048 2.88-2.048m-11.2 0q2.88 0 2.88 2.048v18.24q0 2.112-2.88 2.112T0 25.088V6.848Q0 4.8 2.88 4.8"},null,-1),et=[tt];function at(t,e){return l(),p("svg",Z,[...et])}const it={render:at},rt={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 28 32"},st=i("path",{d:"M13.728 6.272v19.456q0 .448-.352.8t-.8.32-.8-.32l-5.952-5.952H1.152q-.48 0-.8-.352t-.352-.8v-6.848q0-.48.352-.8t.8-.352h4.672l5.952-5.952q.32-.32.8-.32t.8.32.352.8M20.576 16q0 1.344-.768 2.528t-2.016 1.664q-.16.096-.448.096-.448 0-.8-.32t-.32-.832q0-.384.192-.64t.544-.448.608-.384.512-.64.192-1.024-.192-1.024-.512-.64-.608-.384-.544-.448-.192-.64q0-.48.32-.832t.8-.32q.288 0 .448.096 1.248.48 2.016 1.664T20.576 16m4.576 0q0 2.72-1.536 5.056t-4 3.36q-.256.096-.448.096-.48 0-.832-.352t-.32-.8q0-.704.672-1.056 1.024-.512 1.376-.8 1.312-.96 2.048-2.4T22.848 16t-.736-3.104-2.048-2.4q-.352-.288-1.376-.8-.672-.352-.672-1.056 0-.448.32-.8t.8-.352q.224 0 .48.096 2.496 1.056 4 3.36T25.152 16m4.576 0q0 4.096-2.272 7.552t-6.048 5.056q-.224.096-.448.096-.48 0-.832-.352t-.32-.8q0-.64.704-1.056l.384-.192q.256-.128.416-.192.8-.448 1.44-.896 2.208-1.632 3.456-4.064T27.424 16t-1.216-5.152-3.456-4.064q-.64-.448-1.44-.896-.128-.096-.416-.192t-.384-.192q-.704-.416-.704-1.056 0-.448.32-.8t.832-.352q.224 0 .448.096 3.776 1.632 6.048 5.056T29.728 16"},null,-1),ot=[st];function lt(t,e){return l(),p("svg",rt,[...ot])}const nt={render:lt},dt={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 28 32"},ut=i("path",{d:"M13.728 6.272v19.456q0 .448-.352.8t-.8.32-.8-.32l-5.952-5.952H1.152q-.48 0-.8-.352t-.352-.8v-6.848q0-.48.352-.8t.8-.352h4.672l5.952-5.952q.32-.32.8-.32t.8.32.352.8M20.576 16q0 1.344-.768 2.528t-2.016 1.664q-.16.096-.448.096-.448 0-.8-.32t-.32-.832q0-.384.192-.64t.544-.448.608-.384.512-.64.192-1.024-.192-1.024-.512-.64-.608-.384-.544-.448-.192-.64q0-.48.32-.832t.8-.32q.288 0 .448.096 1.248.48 2.016 1.664T20.576 16"},null,-1),ht=[ut];function pt(t,e){return l(),p("svg",dt,[...ht])}const yt={render:pt},ct={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 28 32"},mt=i("path",{d:"M13.728 6.272v19.456q0 .448-.352.8t-.8.32-.8-.32l-5.952-5.952H1.152q-.48 0-.8-.352t-.352-.8v-6.848q0-.48.352-.8t.8-.352h4.672l5.952-5.952q.32-.32.8-.32t.8.32.352.8"},null,-1),vt=[mt];function gt(t,e){return l(),p("svg",ct,[...vt])}const wt={render:gt},ft={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},St=i("path",{d:"m22.667 4 7 6-7 6 7 6-7 6v-4h-3.653l-3.76-3.76 2.827-2.827L20.668 20h2v-8h-2l-12 12h-6v-4h4.347l12-12h3.653V4zm-20 4h6l3.76 3.76L9.6 14.587 7.013 12H2.666z"},null,-1),Tt=[St];function xt(t,e){return l(),p("svg",ft,[...Tt])}const Lt={render:xt},Bt={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},bt=i("path",{d:"M.622 18.334h19.54v7.55l11.052-9.412-11.052-9.413v7.549H.622z"},null,-1),kt=[bt];function Mt(t,e){return l(),p("svg",Bt,[...kt])}const $t={render:Mt},Et={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 22 32"},Rt=i("path",{d:"M20.8 14.4q.704 0 1.152.48T22.4 16t-.48 1.12-1.12.48H1.6q-.64 0-1.12-.48T0 16t.448-1.12T1.6 14.4zM1.6 11.2q-.64 0-1.12-.48T0 9.6t.448-1.12T1.6 8h19.2q.704 0 1.152.48T22.4 9.6t-.48 1.12-1.12.48zm19.2 9.6q.704 0 1.152.48t.448 1.12-.48 1.12-1.12.48H1.6q-.64 0-1.12-.48T0 22.4t.448-1.12T1.6 20.8z"},null,-1),qt=[Rt];function Ct(t,e){return l(),p("svg",Et,[...qt])}const Nt={render:Ct},Ot={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 29 32"},zt=i("path",{d:"M9.333 9.333h13.333v4L27.999 8l-5.333-5.333v4h-16v8h2.667zm13.334 13.334H9.334v-4L4.001 24l5.333 5.333v-4h16v-8h-2.667v5.333z"},null,-1),Ft=[zt];function Ht(t,e){return l(),p("svg",Ot,[...Ft])}const It={render:Ht},At={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 33 32"},Vt=i("path",{d:"M9.333 9.333h13.333v4L27.999 8l-5.333-5.333v4h-16v8h2.667zm13.334 13.334H9.334v-4L4.001 24l5.333 5.333v-4h16v-8h-2.667v5.333zM17.333 20v-8H16l-2.667 1.333v1.333h2v5.333z"},null,-1),Ut=[Vt];function Dt(t,e){return l(),p("svg",At,[...Ut])}const Pt={render:Dt},Yt={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 29 32"},jt=i("path",{d:"m2.667 7.027 1.707-1.693 22.293 22.293-1.693 1.707-4-4H9.334v4l-5.333-5.333 5.333-5.333v4h8.973l-8.973-8.973v.973H6.667v-3.64zm20 10.306h2.667v5.573l-2.667-2.667v-2.907zm0-10.666v-4L28 8l-5.333 5.333v-4H11.76L9.093 6.666z"},null,-1),Wt=[jt];function _t(t,e){return l(),p("svg",Yt,[...Wt])}const Xt={render:_t},Jt={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},Qt=i("path",{d:"M4 16C4 9.4 9.4 4 16 4s12 5.4 12 12c0 1.2-.8 2-2 2s-2-.8-2-2c0-4.4-3.6-8-8-8s-8 3.6-8 8 3.6 8 8 8c1.2 0 2 .8 2 2s-.8 2-2 2C9.4 28 4 22.6 4 16"},null,-1),Gt=[Qt];function Kt(t,e){return l(),p("svg",Jt,[...Gt])}const Zt={render:Kt},te={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},ee=i("path",{d:"M22 16 11.895 5.4 10 7.387 18.211 16 10 24.612l1.895 1.988 8.211-8.613z"},null,-1),ae=[ee];function ie(t,e){return l(),p("svg",te,[...ae])}const re={render:ie},se={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},oe=i("path",{d:"M25.468 6.947a1 1 0 0 0-1.03.057L18 11.384V7.831a1.001 1.001 0 0 0-1.562-.827l-12 8.164a1 1 0 0 0 0 1.654l12 8.168A.999.999 0 0 0 18 24.164v-3.556l6.438 4.382A.999.999 0 0 0 26 24.164V7.831c0-.371-.205-.71-.532-.884"},null,-1),le=[oe];function ne(t,e){return l(),p("svg",se,[...le])}const de={render:ne},ue={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},he=i("path",{d:"M26.667 5.333H5.333a2.667 2.667 0 0 0-2.666 2.666v16.002a2.667 2.667 0 0 0 2.666 2.666h21.335a2.667 2.667 0 0 0 2.666-2.666V7.999a2.667 2.667 0 0 0-2.666-2.666zM5.333 16h5.333v2.667H5.333zm13.334 8H5.334v-2.667h13.333zm8 0h-5.333v-2.667h5.333zm0-5.333H13.334V16h13.333z"},null,-1),pe=[he];function ye(t,e){return l(),p("svg",ue,[...pe])}const ce={render:ye},me={__name:"Icon",props:{type:{type:String}},setup(t){const e={play:K,pause:it,volumeUp:nt,volumeDown:yt,volumeOff:wt,orderRandom:Lt,orderList:$t,menu:Nt,loopAll:It,loopOne:Pt,loopNone:Xt,loading:Zt,right:re,skip:de,lrc:ce};return(a,r)=>(l(),k(D(e[t.type])))}},A=me,$=(t,e)=>{const a=t.__vccOpts||t;for(const[r,o]of e)a[r]=o;return a},ve={props:["aplayer"],computed:{ol(){return this.$refs.ol}},methods:{showList(){setTimeout(()=>{this.ol.scrollTop=this.aplayer.index*33},0)},switchList(t){t!==this.aplayer.index?(this.$emit("switchList",t),this.$emit("play")):this.$emit("toggle")}}},ge=["onClick"],we={class:"aplayer-list-index"},fe={class:"aplayer-list-title"},Se={class:"aplayer-list-author"};function Te(t,e,a,r,o,d){return l(),p("div",{class:S(["aplayer-list",{"aplayer-list-hide":!a.aplayer.listFolded}]),style:w({"max-height":`${a.aplayer.listMaxHeight}px`})},[i("ol",{style:w({"max-height":`${a.aplayer.listMaxHeight}px`}),ref:"ol"},[(l(!0),p(F,null,H(a.aplayer.audio,(c,s)=>(l(),p("li",{class:S({"aplayer-list-light":s===a.aplayer.index}),onClick:u=>d.switchList(s)},[i("span",{class:"aplayer-list-cur",style:w({background:`${a.aplayer.coverColor[a.aplayer.index]||c.theme||a.aplayer.theme}`})},null,4),i("span",we,f(s+1),1),i("span",fe,f(c.name),1),i("span",Se,f(c.artist?c.artist:""),1)],10,ge))),256))],4)],6)}const xe=$(ve,[["render",Te]]),Le={props:["aplayer"],computed:{transformStyle(){return{transform:`translateY(-${this.aplayer.lyricIndex*16}px)`,webkitTransform:`translateY(-${this.aplayer.lyricIndex*16}px)`}}}},Be={class:"aplayer-lrc"};function be(t,e,a,r,o,d){return l(),p("div",Be,[i("div",{class:"aplayer-lrc-contents",style:w(d.transformStyle)},[(l(!0),p(F,null,H(a.aplayer.lyrics[a.aplayer.index],(c,s)=>(l(),p("p",{class:S({"aplayer-lrc-current":s===a.aplayer.lyricIndex})},f(c[1]),3))),256))],4)])}const ke=$(Le,[["render",be]]),R=["one","all","none"],q=["list","random"],Me={components:{utils:y,Icon:A},props:["aplayer","audioStatus","styleStatus"],data(){return{aplayerThumbShowStatus:!1,volumeBarShowStatus:!1}},computed:{aplayerBar(){return this.$refs.aplayerBar},volumeBar(){return this.$refs.volumeBar},switchVolumeIcon(){return this.aplayer.muted||this.aplayer.volume<=0?"volumeOff":this.aplayer.volume>=.95?"volumeUp":"volumeDown"},audio(){return this.aplayer.audio[this.aplayer.index]},duration(){return y.secondToTime(this.audioStatus.duration)},playedTime:{get(){return y.secondToTime(this.audioStatus.playedTime)},set(t){this.$emit("playedTime",t)}},disableTimeUpdate:{get(){return this.audioStatus.disableTimeUpdate},set(t){this.$emit("disableTimeUpdate",t)}}},methods:{loopButtonClick(){let t=R.indexOf(this.aplayer.loop);t=(t+1)%R.length,this.$emit("setLoop",R[t])},orderButtonClick(){let t=q.indexOf(this.aplayer.order);t=(t+1)%q.length,this.$emit("setOrder",q[t])},aplayerBarMoving(t){let e=((t.clientX||t.changedTouches[0].clientX)-this.aplayerBar.getBoundingClientRect().left)/this.aplayerBar.clientWidth;e=Math.max(e,0),e=Math.min(e,1),this.playedTime=e*this.audioStatus.duration,this.$emit("updateLyric")},aplayerBarMoveEnd(t){document.removeEventListener(y.eventsName.moveEnd,this.aplayerBarMoveEnd),document.removeEventListener(y.eventsName.moving,this.aplayerBarMoving);let e=((t.clientX||t.changedTouches[0].clientX)-this.aplayerBar.getBoundingClientRect().left)/this.aplayerBar.clientWidth;e=Math.max(e,0),e=Math.min(e,1),this.$emit("seek",e*this.audioStatus.duration),this.disableTimeUpdate=!1},aplayerBarMoveStart(){this.disableTimeUpdate=!0,document.addEventListener(y.eventsName.moving,this.aplayerBarMoving),document.addEventListener(y.eventsName.moveEnd,this.aplayerBarMoveEnd)},volumeBarMoving(t){let e=1-((t.clientY||t.changedTouches[0].clientY)-this.volumeBar.getBoundingClientRect().top)/this.volumeBar.clientHeight;e=Math.max(e,0),e=Math.min(e,1),this.$emit("setVolume",e)},volumeBarMoveEnd(t){this.volumeBarShowStatus=!1,document.removeEventListener(y.eventsName.moveEnd,this.volumeBarMoveEnd),document.removeEventListener(y.eventsName.moving,this.volumeBarMoving);let e=1-((t.clientY||t.changedTouches[0].clientY)-this.volumeBar.getBoundingClientRect().top)/this.volumeBar.clientHeight;e=Math.max(e,0),e=Math.min(e,1),this.$emit("setVolume",e,!0)},volumeBarMoveStart(){this.volumeBarShowStatus=!0,document.addEventListener(y.eventsName.moving,this.volumeBarMoving),document.addEventListener(y.eventsName.moveEnd,this.volumeBarMoveEnd)}},mounted(){this.aplayerBar.parentNode.addEventListener(y.eventsName.moveStart,this.aplayerBarMoveStart),this.volumeBar.parentNode.addEventListener(y.eventsName.moveStart,this.volumeBarMoveStart)},beforeUnmount(){this.aplayerBar.parentNode.removeEventListener(y.eventsName.moveStart,this.aplayerBarMoveStart),this.volumeBar.parentNode.removeEventListener(y.eventsName.moveStart,this.volumeBarMoveStart)}},$e={class:"aplayer-controller"},Ee={class:"aplayer-bar",ref:"aplayerBar"},Re={class:"aplayer-loading-icon"},qe={class:"aplayer-time-inner"},Ce={class:"aplayer-ptime"},Ne={class:"aplayer-dtime"},Oe={class:"aplayer-volume-bar-wrap"},ze={class:"aplayer-volume-bar",ref:"volumeBar"};function Fe(t,e,a,r,o,d){var c,s,u;const n=b("Icon");return l(),p("div",$e,[i("div",{class:"aplayer-bar-wrap",onMouseover:e[0]||(e[0]=h=>o.aplayerThumbShowStatus=!0),onMouseout:e[1]||(e[1]=h=>o.aplayerThumbShowStatus=!1)},[i("div",Ee,[i("div",{class:"aplayer-loaded",style:w({width:`${a.audioStatus.duration?a.audioStatus.loadedTime/a.audioStatus.duration*100:0}%`})},null,4),i("div",{class:"aplayer-played",style:w({width:`${a.audioStatus.duration?a.audioStatus.playedTime/a.audioStatus.duration*100:0}%`,background:`${a.aplayer.coverColor[a.aplayer.index]||((c=d.audio)==null?void 0:c.theme)||a.aplayer.theme}`})},[v(i("span",{class:"aplayer-thumb",style:w({background:`${a.aplayer.coverColor[a.aplayer.index]||((s=d.audio)==null?void 0:s.theme)||a.aplayer.theme}`})},[i("span",Re,[m(n,{type:"loading"})])],4),[[g,o.aplayerThumbShowStatus]])],4)],512)],32),i("div",{class:S({"aplayer-time":!0,"aplayer-time-narrow":a.styleStatus.timeNarrow})},[i("span",qe,[i("span",Ce,f(d.playedTime),1),P(" / "),i("span",Ne,f(d.duration),1)]),i("span",{class:"aplayer-icon aplayer-icon-back",onClick:e[2]||(e[2]=h=>t.$emit("skipBack"))},[m(n,{type:"skip"})]),i("span",{class:"aplayer-icon aplayer-icon-play",onClick:e[3]||(e[3]=h=>t.$emit("toggle"))},[v(m(n,{type:"play"},null,512),[[g,!a.audioStatus.playStatus]]),v(m(n,{type:"pause"},null,512),[[g,a.audioStatus.playStatus]])]),i("span",{class:"aplayer-icon aplayer-icon-forward",onClick:e[4]||(e[4]=h=>t.$emit("skipForward"))},[m(n,{type:"skip"})]),i("div",{class:S(["aplayer-volume-wrap",{"aplayer-volume-bar-wrap-active":o.volumeBarShowStatus}])},[i("button",{type:"button",class:"aplayer-icon aplayer-icon-volume-down",onClick:e[5]||(e[5]=h=>t.$emit("mute"))},[m(n,{type:d.switchVolumeIcon},null,8,["type"])]),i("div",Oe,[i("div",ze,[i("div",{class:"aplayer-volume",style:w({height:`${a.aplayer.muted?0:a.aplayer.volume*100}%`,background:`${a.aplayer.coverColor[a.aplayer.index]||((u=d.audio)==null?void 0:u.theme)||a.aplayer.theme}`})},null,4)],512)])],2),i("button",{type:"button",class:"aplayer-icon aplayer-icon-order",onClick:e[6]||(e[6]=(...h)=>d.orderButtonClick&&d.orderButtonClick(...h))},[v(m(n,{type:"orderList"},null,512),[[g,a.aplayer.order==="list"]]),v(m(n,{type:"orderRandom"},null,512),[[g,a.aplayer.order==="random"]])]),i("button",{type:"button",class:"aplayer-icon aplayer-icon-loop",onClick:e[7]||(e[7]=(...h)=>d.loopButtonClick&&d.loopButtonClick(...h))},[v(m(n,{type:"loopOne"},null,512),[[g,a.aplayer.loop==="one"]]),v(m(n,{type:"loopAll"},null,512),[[g,a.aplayer.loop==="all"]]),v(m(n,{type:"loopNone"},null,512),[[g,a.aplayer.loop==="none"]])]),i("button",{type:"button",class:"aplayer-icon aplayer-icon-menu",onClick:e[8]||(e[8]=h=>t.$emit("toggleList"))},[m(n,{type:"menu"})]),i("button",{type:"button",class:S({"aplayer-icon":!0,"aplayer-icon-lrc":!0,"aplayer-icon-lrc-inactivity":!a.aplayer.lyricShow}),onClick:e[9]||(e[9]=h=>t.$emit("toggleLrc"))},[m(n,{type:"lrc"})],2)],2)])}const He=$(Me,[["render",Fe]]);let T=null;const z=["abort","canplay","canplaythrough","durationchange","emptied","encrypted","ended","error","interruptbegin","interruptend","loadeddata","loadedmetadata","loadstart","mozaudioavailable","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"],Ie={name:"APlayer",components:{smoothScroll:O,utils:y,Icon:A,List:xe,Lyric:ke,Controller:He},props:{audio:{type:Array,default:[]},mode:{type:String,default:"normal"},autoplay:{type:Boolean,default:!1},mutex:{type:Boolean,default:!0},preload:{type:String,default:"metadata"},theme:{type:String,default:"#B7DAFF"},autoSwitch:{type:Boolean,default:!0},loop:{type:String,default:"all"},order:{type:String,default:"list"},muted:{type:Boolean,default:!1},volume:{type:Number,default:.7,validator(t){return t>=0&&t<=1}},lrcType:{type:Number,default:1},lrcShow:{type:Boolean,default:!0},listFolded:{type:Boolean,default:!1},listMaxHeight:{type:Number,default:250},noticeSwitch:{type:Boolean,default:!0},storageName:{type:String,default:"aplayer-setting"}},data(){return{aplayer:{index:0,audio:[],randomOrder:[],mode:this.mode,autoplay:this.autoplay,mutex:this.mutex,preload:this.preload,theme:this.theme,autoSwitch:this.autoSwitch,coverColor:[],loop:this.loop,order:this.order,muted:this.muted,volume:this.volume,lyricType:this.lrcType,lyricShow:this.lrcShow,lyricIndex:0,lyrics:[],listFolded:this.listFolded,listMaxHeight:this.listMaxHeight,noticeSwitch:this.noticeSwitch,noticeText:"",noticeOpacity:0,storageName:this.storageName,storage:{}},audioStatus:{duration:0,loadedTime:0,playedTime:0,playStatus:!1,waitingStatus:!1,disableTimeUpdate:!1},styleStatus:{isMobile:/mobile/i.test(window.navigator.userAgent),narrow:!1,timeNarrow:!1,mini:!0},destroyComponent:!1}},computed:{audioRef(){return this.$refs.audio},coverStyle(){let t=this.aplayer.audio[this.aplayer.index];return t!=null&&t.cover?{"background-image":`url(${t.cover})`,"background-color":`${this.aplayer.coverColor[this.aplayer.index]||(t==null?void 0:t.theme)||this.aplayer.theme}`}:{"background-color":`${this.aplayer.coverColor[this.aplayer.index]||(t==null?void 0:t.theme)||this.aplayer.theme}`}}},methods:{getStorage(t){return this.aplayer.storage[t]},setStorage(t,e){this.aplayer.storage[t]=e,localStorage.setItem(this.aplayer.storageName,JSON.stringify(this.aplayer.storage))},setAudio(t){this.hls&&(this.hls.destroy(),this.hls=null);let e=t.type;(!e||e==="auto")&&(e=/m3u8(#|\?|$)/i.exec(t.url)?"hls":"normal"),e==="hls"?Hls.isSupported()?(this.hls=new Hls,this.hls.loadSource(t.url),this.hls.attachMedia(this.audioRef)):this.audioRef.canPlayType("application/x-mpegURL")||this.audioRef.canPlayType("application/vnd.apple.mpegURL")?this.audioRef.src=t.url:this.setNotice("Error: HLS is not supported."):e==="normal"&&(this.audioRef.src=t.url)},prevIndex(){let t=this.aplayer.index;if(this.aplayer.audio.length>1){if(this.aplayer.order==="list")return t-1<0?this.aplayer.audio.length-1:t-1;if(this.aplayer.order==="random"){let e=this.aplayer.randomOrder.indexOf(t);return e===0?this.aplayer.randomOrder[this.aplayer.randomOrder.length-1]:this.aplayer.randomOrder[e-1]}}else return 0},nextIndex(){let t=this.aplayer.index;if(this.aplayer.audio.length>1){if(this.aplayer.order==="list")return(t+1)%this.aplayer.audio.length;if(this.aplayer.order==="random"){let e=this.aplayer.randomOrder.indexOf(t);return e===this.aplayer.randomOrder.length-1?this.aplayer.randomOrder[0]:this.aplayer.randomOrder[e+1]}}else return 0},coverColor(){var t;let e=!this.aplayer.coverColor[this.aplayer.index];if(this.aplayer.autoSwitch&&e)try{this.colorThief||(this.colorThief=new ColorThief),this.colorThief.getColorAsync((t=this.aplayer.audio[this.aplayer.index])==null?void 0:t.cover,([a,r,o])=>this.aplayer.coverColor[this.aplayer.index]=`rgb(${a}, ${r}, ${o})`)}catch{this.aplayer.autoSwitch=!1,this.setNotice("The color-thief is required to support self-adapting theme.")}},switchStyle(){this.$refs.switch&&(this.$refs.switch.style.display="none",setTimeout(()=>{this.$refs.switch&&(this.$refs.switch.style.display="block")},100))},loadedTime(){return this.audioRef.buffered.length?this.audioRef.buffered.end(this.audioRef.buffered.length-1):0},playedTime(t){this.audioStatus.playedTime=t},disableTimeUpdate(t){this.audioStatus.disableTimeUpdate=t},async loadLyric(t,e){try{let a=await fetch(this.aplayer.audio[e].lrc);a.ok||a.status===304?t=y.parse(await a.text()):this.setNotice("LRC file request fails: status "+a.status)}catch(a){console.warn(a)}finally{this.aplayer.lyrics[e]=t,this.updateLyric()}},switchLyric(t){if(this.aplayer.lyrics[t])return;let e=[[0,"Not available"]];this.aplayer.lyricType===1?(this.aplayer.lyrics[t]=[[0,"Loading"]],this.loadLyric(e,t)):this.aplayer.lyricType===2&&(this.aplayer.audio[t].lrc&&(e=y.parse(this.aplayer.audio[t].lrc)),this.aplayer.lyrics[t]=e,this.updateLyric())},updateLyric(){let t=this.aplayer.lyrics[this.aplayer.index];if(t)for(let e=0;e<t.length;e++){const a=t[e],r=t[e+1];this.audioStatus.playedTime>=a[0]&&(!r||this.audioStatus.playedTime<r[0])&&(this.aplayer.lyricIndex=e)}},init(){this.destroyComponent=!1,this.aplayer.storage=JSON.parse(localStorage.getItem(this.aplayer.storageName))||{},this.aplayer.volume=this.getStorage("volume")||this.aplayer.volume,this.audioRef.preload=this.aplayer.preload,this.audioRef.muted=this.aplayer.muted,this.audioRef.volume=this.aplayer.volume,z.forEach(t=>{this.audioRef.addEventListener(t,e=>this.$emit(t,e))}),this.audioRef.addEventListener("play",()=>this.audioStatus.playStatus=!0),this.audioRef.addEventListener("pause",()=>this.audioStatus.playStatus=!1),this.audioRef.addEventListener("timeupdate",this.timeupdate),this.audioRef.addEventListener("durationchange",this.durationchange),this.audioRef.addEventListener("loadedmetadata",this.loadedmetadata),this.audioRef.addEventListener("canplay",this.canplay),this.audioRef.addEventListener("progress",this.progress),this.audioRef.addEventListener("error",this.error),this.audioRef.addEventListener("ended",this.ended),this.audioRef.addEventListener("waiting",this.waiting),this.audioRef.addEventListener("playing",this.playing),window.addEventListener("resize",this.resize),this.addList(this.audio,!0),this.aplayer.autoplay&&this.play(),this.$emit("init")},play(){this.switchStyle(),this.audioStatus.playStatus=!0,this.$nextTick(()=>{this.audioStatus.playStatus=!0,this.aplayer.mutex&&(T&&T!==this&&T.pause(),T=this);const t=this.audioRef.play();t&&t.catch(e=>{console.warn(e),e.name==="NotAllowedError"&&(this.audioStatus.playStatus=!1)})})},pause(){this.switchStyle(),this.audioStatus.playStatus=!1,this.audioRef.pause()},toggle(){this.audioStatus.playStatus?this.pause():this.play()},seek(t){t=Math.max(t,0),t=Math.min(t,this.audioStatus.duration),this.audioStatus.playedTime=t,this.audioRef.currentTime=t},mute(){this.aplayer.muted=!this.aplayer.muted,this.audioRef.muted=!this.audioRef.muted},setVolume(t,e=!1){t=parseFloat(t),isNaN(t)||(t=Math.max(t,0),t=Math.min(t,1),this.aplayer.volume=t,this.audioRef.volume=t,e&&this.setStorage("volume",t),this.aplayer.muted&&this.mute())},setTheme(t,e=this.aplayer.index){t&&(this.aplayer.coverColor[e]?this.aplayer.coverColor[e]=t:this.aplayer.audio[e]&&(this.aplayer.audio[e].theme=t))},setMode(t="normal"){this.aplayer.mode=t,this.resize()},setLoop(t){this.aplayer.audio.length<=1&&t==="one"&&(t="all"),this.aplayer.loop=t},setOrder(t){this.aplayer.order=t},setNotice(t,e=2e3,a=.8){if(!this.aplayer.noticeSwitch||this.aplayer.mode==="mini"||this.aplayer.mode==="fixed"&&this.styleStatus.mini){console.warn(t);return}this.aplayer.noticeText=t,this.aplayer.noticeOpacity=a,this.noticeTimeout&&clearTimeout(this.noticeTimeout),this.$emit("noticeshow"),e&&(this.noticeTimeout=setTimeout(()=>{this.aplayer.noticeOpacity=0,this.$emit("noticehide")},e))},skipBack(){this.switchList(this.prevIndex())},skipForward(){this.switchList(this.nextIndex())},destroy(){this.destroyComponent=!0,this.$emit("destroy")},showLrc(){this.$emit("lrcshow"),this.aplayer.lyricShow=!0},hideLrc(){this.$emit("lrchide"),this.aplayer.lyricShow=!1},toggleLrc(){this.aplayer.lyricShow?this.hideLrc():this.showLrc()},showList(){this.$emit("listshow"),this.aplayer.mode!=="mini"&&this.$refs.list.showList(),this.aplayer.listFolded=!0},hideList(){this.$emit("listhide"),this.aplayer.listFolded=!1},toggleList(){this.aplayer.listFolded?this.hideList():this.showList()},addList(t,e=!1){this.$emit("listadd",t),Object.prototype.toString.call(t)!=="[object Array]"&&(t=[t]),t.map(r=>(r.name=r.name||r.title||"Audio Name",r.artist=r.artist||r.author||"Audio Artist",r.cover=r.cover||r.pic,r.type=r.type||"normal",r));const a=this.aplayer.audio.length===0;if(e&&(this.aplayer.audio=[]),this.aplayer.audio=this.aplayer.audio.concat(t),this.aplayer.randomOrder=y.randomOrder(this.aplayer.audio.length),a){let r=0;this.aplayer.order==="random"&&(r=this.aplayer.randomOrder[0]),this.switchList(r)}},removeList(t){this.$emit("listremove",nextIndex),this.aplayer.coverColor.splice(t,1),this.aplayer.randomOrder.splice(this.aplayer.randomOrder.indexOf(this.aplayer.audio.length-1),1),this.aplayer.audio[t]&&(this.aplayer.audio.length>1?(this.aplayer.audio.splice(t,1),t===this.aplayer.index&&(this.aplayer.audio[t]?this.switchList(t):this.switchList(t-1)),this.aplayer.index>t&&this.aplayer.index--):this.clearList()),this.aplayer.lyrics.splice(t,1)},switchList(t){this.$emit("listswitch",t),typeof t<"u"&&this.aplayer.audio[t]&&(this.aplayer.index=t,this.coverColor(),this.aplayer.mode!=="mini"&&O(t*33,500,null,this.$refs.list.ol),this.setAudio(this.aplayer.audio[t]),this.switchLyric(t),this.audioStatus.duration=0,this.audioStatus.playedTime=0)},clearList(){this.$emit("listclear"),this.pause(),this.audioRef.src="",this.aplayer.audio=[],this.aplayer.randomOrder=[],this.aplayer.coverColor=[],this.aplayer.lyrics=[],this.aplayer.index=0,this.aplayer.lyricIndex=0,this.audioStatus.duration=0,this.audioStatus.loadedTime=0,this.audioStatus.playedTime=0,this.audioStatus.playStatus=!1,this.audioStatus.waitingStatus=!1,this.audioStatus.disableTimeUpdate=!1},timeupdate(){this.audioStatus.disableTimeUpdate||(this.audioStatus.playedTime=this.audioRef.currentTime),this.updateLyric()},durationchange(){this.audioStatus.duration=this.audioRef.duration},loadedmetadata(){this.seek(0),this.audioStatus.playStatus&&this.audioRef.play()},canplay(){this.audioStatus.loadedTime=this.loadedTime()},progress(){this.audioStatus.loadedTime=this.loadedTime()},error(){if(this.aplayer.audio.length>1){let t=this.audioStatus.playStatus;this.setNotice("An audio error has occurred, player will skip forward in 2 seconds."),this.skipForwardTimeout&&clearTimeout(this.skipForwardTimeout),this.skipForwardTimeout=setTimeout(()=>{this.skipForward(),t&&this.play()},2e3)}else this.aplayer.audio.length===1&&this.setNotice("An audio error has occurred.")},ended(){let t=this.aplayer.index;this.aplayer.loop==="none"?(this.skipForward(),this.aplayer.order==="list"?t<this.aplayer.audio.length-1?this.play():this.pause():this.aplayer.order==="random"&&(this.aplayer.randomOrder.indexOf(t)<this.aplayer.randomOrder.length-1?this.play():this.pause())):this.aplayer.loop==="one"?(this.switchList(t),this.play()):this.aplayer.loop==="all"&&(this.skipForward(),this.play())},waiting(){this.audioStatus.waitingStatus=!0},playing(){this.audioStatus.waitingStatus=!1},resize(){this.aplayer.mode==="normal"?(this.styleStatus.narrow=this.$refs.aplayer.offsetWidth<=300,this.styleStatus.timeNarrow=this.$refs.info.offsetWidth<=200):(this.styleStatus.narrow=window.innerWidth<=318,this.styleStatus.timeNarrow=!0)}},watch:{audio(t){this.addList(t,!0)}},mounted(){this.init()},beforeUnmount(){this.clearList(),this.hls&&this.hls.destroy(),T===this&&(T=null),this.colorThief=null,this.noticeTimeout&&clearTimeout(this.noticeTimeout),this.skipForwardTimeout&&clearTimeout(this.skipForwardTimeout),z.forEach(t=>{this.audioRef.removeEventListener(t,e=>this.$emit(t,e))}),this.audioRef.removeEventListener("play",()=>this.audioStatus.playStatus=!0),this.audioRef.removeEventListener("pause",()=>this.audioStatus.playStatus=!1),this.audioRef.removeEventListener("timeupdate",this.timeupdate),this.audioRef.removeEventListener("durationchange",this.durationchange),this.audioRef.removeEventListener("loadedmetadata",this.loadedmetadata),this.audioRef.removeEventListener("canplay",this.canplay),this.audioRef.removeEventListener("progress",this.progress),this.audioRef.removeEventListener("error",this.error),this.audioRef.removeEventListener("ended",this.ended),this.audioRef.removeEventListener("waiting",this.waiting),this.audioRef.removeEventListener("playing",this.playing),window.removeEventListener("resize",this.resize)}},Ae=Ie,Ve={ref:"switch"},Ue={class:"aplayer-info",ref:"info"},De={class:"aplayer-music"},Pe={class:"aplayer-title"},Ye={class:"aplayer-author"},je={class:"aplayer-icon"},We={ref:"audio"};function _e(t,e,a,r,o,d){const c=b("List"),s=b("Icon"),u=b("Lyric"),n=b("Controller");return t.destroyComponent?B("",!0):(l(),p("div",{key:0,class:S(["aplayer",{"aplayer-narrow":t.styleStatus.narrow,"aplayer-fixed":t.aplayer.mode==="fixed","aplayer-mini":t.aplayer.mode==="mini"||t.aplayer.mode==="fixed"&&t.styleStatus.mini,"aplayer-loading":t.audioStatus.playStatus&&t.audioStatus.waitingStatus,"aplayer-withlist":t.aplayer.audio.length>1,"aplayer-withlrc":t.aplayer.mode==="normal"&&t.aplayer.lyricShow,"aplayer-mobile":t.styleStatus.isMobile}]),ref:"aplayer"},[t.aplayer.mode==="fixed"?(l(),k(c,{key:0,aplayer:t.aplayer,onPlay:t.play,onToggle:t.toggle,onSwitchList:t.switchList,ref:"list"},null,8,["aplayer","onPlay","onToggle","onSwitchList"])):B("",!0),i("div",{class:"aplayer-body",style:w({width:`${t.aplayer.mode==="fixed"?"calc(100% - 18px)":"100%"}`})},[i("div",{class:"aplayer-pic",style:w(t.coverStyle),onClick:e[0]||(e[0]=(...h)=>t.toggle&&t.toggle(...h))},[i("div",{class:S(["aplayer-button",{"aplayer-play":!t.audioStatus.playStatus,"aplayer-pause":t.audioStatus.playStatus}])},[i("div",Ve,[v(m(s,{type:"play"},null,512),[[g,!t.audioStatus.playStatus]]),v(m(s,{type:"pause"},null,512),[[g,t.audioStatus.playStatus]])],512)],2)],4),i("div",Ue,[i("div",De,[i("span",Pe,f(t.aplayer.audio[t.aplayer.index]?t.aplayer.audio[t.aplayer.index].name:"No Audio"),1),i("span",Ye,f(t.aplayer.audio[t.aplayer.index]?" - "+t.aplayer.audio[t.aplayer.index].artist:""),1)]),t.aplayer.mode==="normal"?v((l(),k(u,{key:0,aplayer:t.aplayer,ref:"lyric"},null,8,["aplayer"])),[[g,t.aplayer.lyricShow]]):B("",!0),m(n,{aplayer:t.aplayer,audioStatus:t.audioStatus,styleStatus:t.styleStatus,onPlayedTime:t.playedTime,onDisableTimeUpdate:t.disableTimeUpdate,onToggle:t.toggle,onSkipBack:t.skipBack,onSkipForward:t.skipForward,onSeek:t.seek,onMute:t.mute,onSetLoop:t.setLoop,onSetOrder:t.setOrder,onToggleList:t.toggleList,onToggleLrc:t.toggleLrc,onSetVolume:t.setVolume},null,8,["aplayer","audioStatus","styleStatus","onPlayedTime","onDisableTimeUpdate","onToggle","onSkipBack","onSkipForward","onSeek","onMute","onSetLoop","onSetOrder","onToggleList","onToggleLrc","onSetVolume"])],512),i("div",{class:"aplayer-notice",style:w({opacity:t.aplayer.noticeOpacity})},f(t.aplayer.noticeText),5),i("div",{class:"aplayer-miniswitcher",onClick:e[1]||(e[1]=h=>t.styleStatus.mini=!t.styleStatus.mini)},[i("button",je,[m(s,{type:"right"})])])],4),t.aplayer.mode==="normal"?(l(),k(c,{key:1,aplayer:t.aplayer,onPlay:t.play,onToggle:t.toggle,onSwitchList:t.switchList,ref:"list"},null,8,["aplayer","onPlay","onToggle","onSwitchList"])):B("",!0),t.aplayer.mode==="fixed"?v((l(),k(u,{key:2,aplayer:t.aplayer,ref:"lyric"},null,8,["aplayer"])),[[g,t.aplayer.lyricShow]]):B("",!0),i("audio",We,null,512)],2))}const C=$(Ae,[["render",_e]]);C.install=t=>{t.component(C.name,C)};export{C as default};
